<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Список песен</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1 {
            text-align: center;
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
        }
        select {
            padding: 10px;
            margin-bottom: 10px;
            width: 100%;
        }
        #song-content {
            white-space: pre-wrap;
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <h1>Список песен</h1>
    <div class="controls">
        <label for="sheet-select">Выберите лист:</label>
        <select id="sheet-select">
            <option value="">-- Выберите лист --</option>
            <option value="Быстрые (вертикаль)">Быстрые (вертикаль)</option>
            <option value="Быстрые (горизонталь)">Быстрые (горизонталь)</option>
            <option value="Поклонение (вертикаль)">Поклонение (вертикаль)</option>
            <option value="Поклонение (горизонталь)">Поклонение (горизонталь)</option>
        </select>

        <label for="song-select">Выберите песню:</label>
        <select id="song-select" disabled>
            <option value="">-- Сначала выберите лист --</option>
        </select>
    </div>
    <div id="song-content">
        Выберите песню, чтобы увидеть её текст и аккорды.
    </div>
    <script>
        const API_KEY = 'AIzaSyDO2gwifAnZzC3ooJ0A_4vAD76iYakwzlk'; // Ваш API-ключ
        const SHEET_ID = '1C3gFjj9LAub_Nk9ogqKp3LKpdAxq6j8xlPAsc8OmM5s'; // Ваш ID таблицы
        const SHEETS = {
            'Быстрые (вертикаль)': 'Лист1',
            'Быстрые (горизонталь)': 'Лист2',
            'Поклонение (вертикаль)': 'Лист3',
            'Поклонение (горизонталь)': 'Лист4'
        };

        const sheetSelect = document.getElementById('sheet-select');
        const songSelect = document.getElementById('song-select');
        const songContent = document.getElementById('song-content');

        async function fetchSheetData(sheetName) {
            const range = `${sheetName}!A2:E`;
            const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${range}?key=${API_KEY}`;
            const response = await fetch(url);
            return response.json();
        }

        sheetSelect.addEventListener('change', async () => {
            const sheetName = SHEETS[sheetSelect.value];
            if (!sheetName) return;

            const data = await fetchSheetData(sheetName);
            const rows = data.values || [];

            // Очистка списка песен
            songSelect.innerHTML = '<option value="">-- Выберите песню --</option>';
            rows.forEach((row, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = row[0]; // Название песни
                songSelect.appendChild(option);
            });

            songSelect.disabled = rows.length === 0;
        });

        songSelect.addEventListener('change', () => {
            const sheetName = SHEETS[sheetSelect.value];
            const songIndex = songSelect.value;

            if (sheetName && songIndex !== '') {
                fetchSheetData(sheetName).then(data => {
                    const rows = data.values || [];
                    const songData = rows[songIndex];
                    if (songData) {
                        const [title, lyrics, key, link, bpm] = songData;
                        songContent.innerHTML = `
                            <h2>${title} — ${key} (BPM: ${bpm || 'N/A'})</h2>
                            <a href="${link}" target="_blank">Оригинал</a>
                            <pre>${lyrics}</pre>
                        `;
                    }
                });
            } else {
                songContent.innerHTML = 'Выберите песню, чтобы увидеть её текст и аккорды.';
            }
        });
    </script>
</body>
</html>
